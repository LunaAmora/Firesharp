true  :: 1 #bool end
false :: 0 #bool end
null  :: 0 #ptr end

!bool : bool ptr : !32 end
!ptr  : ptr  ptr : !32 end
!int  : int  ptr : !32 end
@bool : ptr -> bool : @32 #bool end
@ptr  : ptr -> ptr  : @32 #ptr end
@int  : ptr -> int  : @32 end

inc32 : ptr : dup @32 1 + swap !32 end
dec32 : ptr : dup @32 1 - swap !32 end

+ptr : int ptr -> ptr : swap #ptr + end
ptr+ : ptr int -> ptr : #ptr + end
ptr- : ptr int -> ptr : #ptr - end

str :
  len  int
  data ptr
end

ciovec :
  buf     ptr
  buf_len int
end

@str : *str -> str :
  dup .len swap .data
end

puts : *str :
  iov ciovec:= end
  written: 4 end
  @str swap !iov
  1 *iov #ptr 1 written fd_write drop
end

print : str :
  string str:= end
  !string *string puts
end

hello str :: "Hello World\n" end

start ::
  hello print
end
